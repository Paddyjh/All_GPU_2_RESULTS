Failure # 1 (occurred at 2025-08-03_11-40-16)
[36mray::ImplicitFunc.train()[39m (pid=536660, ip=134.226.40.133, actor_id=3bcbe63df77c126fbd388edf01000000, repr=run_training)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/tune/trainable/trainable.py", line 330, in train
    raise skipped from exception_cause(skipped)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/air/_internal/util.py", line 107, in run
    self._ret = self._target(*self._args, **self._kwargs)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 45, in <lambda>
    training_func=lambda: self._trainable_func(self.config),
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/tune/trainable/function_trainable.py", line 261, in _trainable_func
    output = fn()
  File "/home/patrick/dissertation_code/original_pop.py", line 235, in run_training
    tune.report(metrics = {"loss": val_loss, "train_loss": train_loss, "iter": iter, 'beta_1': beta_1, "beta_2": beta_2}, checkpoint=Checkpoint.from_directory(tempdir))  # Report loss and accuracy
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/train/_internal/session.py", line 663, in wrapper
    return fn(*args, **kwargs)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/tune/trainable/trainable_fn_utils.py", line 48, in report
    get_session().report(metrics, checkpoint=checkpoint)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/train/_internal/session.py", line 429, in report
    persisted_checkpoint = self.storage.persist_current_checkpoint(checkpoint)
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/train/_internal/storage.py", line 547, in persist_current_checkpoint
    self._check_validation_file()
  File "/home/patrick/dissertation_code/myenv/lib/python3.10/site-packages/ray/train/_internal/storage.py", line 499, in _check_validation_file
    raise RuntimeError(
RuntimeError: Unable to set up cluster storage with the following settings:
StorageContext<
  storage_filesystem='local',
  storage_fs_path='/home/patrick/ray_results_POPULATION_RESAMPLE_TEST_ORIGINAL_IMPL',
  experiment_dir_name='POPULATION_ORG_IMPL_pilot_1hr_config_test_UNLIMITED, SEED 2001,  perturb: DEFAULT, burn_in: DEFAULT, quant_f: DEFAULT, resamp_prob: DEFAULT, pertrb_f: DEFAULT',
  trial_dir_name='run_training_018fe_00001_1_epsilon=0.0000,lr=0.0983,seed=909823972,weight_decay=0.0086,x_beta1=-7.7338,x_beta2=2.7341_2025-08-03_11-38-35',
  current_checkpoint_index=2,
>
Check that all nodes in the cluster have read/write access to the configured storage path. `RunConfig(storage_path)` should be set to a cloud storage URI or a shared filesystem path accessible by all nodes in your cluster ('s3://bucket' or '/mnt/nfs'). A local path on the head node is not accessible by worker nodes. See: https://docs.ray.io/en/latest/train/user-guides/persistent-storage.html
